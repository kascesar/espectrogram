<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FFT Deslizante</title>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] },
  TeX: { equationNumbers: { autoNumber: 'all' } }
});
</script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<style>
body > * {
  max-width: 42em;
}
body {
  font-family: "Roboto Condensed", sans-serif;
  padding-left: 7.5em;
  padding-right: 7.5em;
}
pre, code {
  max-width: 50em;
  font-family: monospace;
}
pre.oct-code {
  border: 1px solid Grey;
  padding: 5px;
}
pre.oct-code-output {
  margin-left: 2em;
}
span.comment {
  color: ForestGreen;
}
span.keyword {
  color: Blue;
}
span.string {
  color: DarkOrchid;
}
footer {
  margin-top: 2em;
  font-size: 80%;
}
a, a:visited {
  color: Blue;
}
h2 {
  font-family: "Roboto Condensed", serif;
  margin-top: 1.5em;
}
h2 a, h2 a:visited {
  color: Black;
}
</style>
</head>
<body>
<h1>FFT Deslizante</h1>
<h2>Contents</h2><ul><li><a href="#node1">Preparativos</a></li><li><a href="#node2">Problema a tratar</a></li><li><a href="#node3">Source Code</a></li><li><a href="#node4">Conclusion</a></li><li><a href="#node5">external links</a></li></ul><p>Explicacion</p><pre class="pre-text">Consiste en una Transformada de furier rapida (FFT) para
una señal con la funcion specgram
Se mostrara un ejemplo de como usar la funcion specgram
en pctave, aplicada a alguna señal que no es continua.</pre><pre class="pre-text">Será contrastado con variadas velocidades de la ventana.
Y veremos como cambia el resultado de dicha FFT.</pre><h2><a id="node1">Preparativos</a></h2><p>Informacion para los preparativos previos</p><pre class="pre-text">*Como instalar un paquete*
Sobre linux acceda a una terminal y teclee :</pre><pre class="pre-code">sudo apt-get install liboctave-dev</pre><pre class="pre-text">En la consola de octave instale los siguientes paquetes:</pre><ul><li>signal</li><li>specfun</li></ul><pre class="pre-text">Con los siguientes comandos:</pre><pre class="pre-code">pkg install -forge signal
pkg install -forge specfun</pre><pre class="pre-text">Cargamos los nuevos paquetes :</pre><pre class="pre-code">pkg load signal specfun</pre><pre class="pre-text">y a estamos preparados para empezar</pre><h2><a id="node2">Problema a tratar</a></h2><p><b>Transformada de fourier deslizante</b></p><pre class="pre-text">Encuentre la transformada de Fourier deslizante para la siguiente funcion
compuesta por una función hecha de cuatro partes continuas:</pre><p>$$f(x)= \left\{ \begin{array}{lcc}
            cos(2 \pi 10 t) &   si  & 0s < t < 5s
            \\ cos(2 \pi 25 t) & si & 5s < t < 10s
            \\ cos(2 \pi 50 t) & si & 10s < t <  15s
            \\ cos(2 \pi 100 t) & si & 15s < t < 20s
            \end{array}
\right.$$
 Hagalo para 4 velocidades diferentes de la ventana que hace la FFT en esta funcion.
 Note el contraste del cambio.</p><h2><a id="node3">Source Code</a></h2><pre class="oct-code">T=20;
Fs=1000;
t=linspace(0,T,T*Fs);
x=[];
<span class="keyword">for</span> n=1:length(t)
    x1 = cos(2*pi*10*t(n))*heaviside(5-t(n));
    x2 = cos(2*pi*25*t(n))*heaviside(t(n)-5)*heaviside(10-t(n));
    x3 = cos(2*pi*50*t(n))*heaviside(t(n)-10)*heaviside(15-t(n));
    x4 = cos(2*pi*100*t(n))*heaviside(t(n)-15);
    x=[x,x1+x2+x3+x4];
<span class="keyword">end</span>
vel=25; <span class="comment">%windows velociti</span>
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b0,c0] = specgram(x, 2^nextpow2(window), Fs, window, window-step);
a0 = abs(a);

vel=125;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b1,c1]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a1 = abs(a);

vel=375;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b2,c2]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a2 = abs(a);

vel=1000;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b3,c3]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a3 = abs(a);

<span class="comment">% Graficos</span>
figure (1);;title(<span class="string">'Grafico Señal'</span>);
plot(t,x,<span class="string">'b-'</span>);title(<span class="string">'Grafico Señal'</span>);xlabel(<span class="string">'Time [s]'</span>);ylabel(<span class="string">'Amplitud'</span>)

figure (2);title (<span class="string">'FFT ventana deslizante'</span>);
subplot(2,2,1);imagesc (c0, b0, log(a0));title (<span class="string">'Windows 25 Hrtz'</span>);
subplot(2,2,2);imagesc (c1, b1, log(a1));title (<span class="string">'Windows 125 Hrtz'</span>);
subplot(2,2,3);imagesc (c2, b2, log(a2));title (<span class="string">'Windows 375 Hrtz'</span>);
subplot(2,2,4);imagesc (c3, b3, log(a3));title (<span class="string">'Windows 1000 Hrtz'</span>);</pre><pre class="oct-code-output"></pre><img src="espectrograma-1.jpg" alt="espectrograma-1.jpg"><img src="espectrograma-2.jpg" alt="espectrograma-2.jpg"><h2><a id="node4">Conclusion</a></h2><pre class="pre-text">vemos que mientras mas rapido pasa la ventana menos ruidoza es la vetana ya
que no ve tanto mas significativamente los los bruscos cambios que poosee esta
funcion.</pre><h2><a id="node5">external links</a></h2><p>Porfavor, acceda a la documentacion:</p><ol><li>Signal processing in octave <a href="https://www.gnu.org/software/octave/doc/interpreter/Signal-Processing.html">https://www.gnu.org/software/octave/doc/interpreter/Signal-Processing.html</a></li></ol><ol><li>funcion specgram <a href="https://octave.sourceforge.io/signal/function/specgram.html">https://octave.sourceforge.io/signal/function/specgram.html</a></li></ol>
<footer><hr><a href="http://www.octave.org">Published with GNU Octave 4.2.1</a></footer>
<!--
##### SOURCE BEGIN #####
%% FFT Deslizante
%%
% Explicacion
%
%  Consiste en una Transformada de furier rapida (FFT) para
%  una señal con la funcion specgram
%  Se mostrara un ejemplo de como usar la funcion specgram
%  en pctave, aplicada a alguna señal que no es continua.
%
%  Será contrastado con variadas velocidades de la ventana.
%  Y veremos como cambia el resultado de dicha FFT.
%% Preparativos
%%
% Informacion para los preparativos previos
%
%  *Como instalar un paquete*
%  Sobre linux acceda a una terminal y teclee :
%
%   sudo apt-get install liboctave-dev
%
%  En la consola de octave instale los siguientes paquetes:
%
% * signal
% * specfun
%
%  Con los siguientes comandos:
%
%   pkg install -forge signal
%   pkg install -forge specfun
%
%  Cargamos los nuevos paquetes :
%
%   pkg load signal specfun
%
%  y a estamos preparados para empezar
%% Problema a tratar
%%
% *Transformada de fourier deslizante*
%
%  Encuentre la transformada de Fourier deslizante para la siguiente funcion
%  compuesta por una función hecha de cuatro partes continuas:
%
% $$f(x)= \left\{ \begin{array}{lcc}
%             cos(2 \pi 10 t) &   si  & 0s < t < 5s
%             \\ cos(2 \pi 25 t) & si & 5s < t < 10s
%             \\ cos(2 \pi 50 t) & si & 10s < t <  15s
%             \\ cos(2 \pi 100 t) & si & 15s < t < 20s
%             \end{array}
% \right.$$
%  Hagalo para 4 velocidades diferentes de la ventana que hace la FFT en esta funcion.
%  Note el contraste del cambio.
%% Source Code
T=20;
Fs=1000;
t=linspace(0,T,T*Fs);
x=[];
for n=1:length(t)
    x1 = cos(2*pi*10*t(n))*heaviside(5-t(n));
    x2 = cos(2*pi*25*t(n))*heaviside(t(n)-5)*heaviside(10-t(n));
    x3 = cos(2*pi*50*t(n))*heaviside(t(n)-10)*heaviside(15-t(n));
    x4 = cos(2*pi*100*t(n))*heaviside(t(n)-15);
    x=[x,x1+x2+x3+x4];
end
vel=25; %windows velociti
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b0,c0] = specgram(x, 2^nextpow2(window), Fs, window, window-step);
a0 = abs(a);

vel=125;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b1,c1]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a1 = abs(a);

vel=375;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b2,c2]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a2 = abs(a);

vel=1000;
window = fix(vel*Fs/1000);
fftn = 2^nextpow2(window);
step = fix(2*Fs/1000);
[a,b3,c3]=specgram(x, 2^nextpow2(window), Fs, window, window-step);
a3 = abs(a);

% Graficos
figure (1);;title('Grafico Señal');
plot(t,x,'b-');title('Grafico Señal');xlabel('Time [s]');ylabel('Amplitud')

figure (2);title ('FFT ventana deslizante');
subplot(2,2,1);imagesc (c0, b0, log(a0));title ('Windows 25 Hrtz');
subplot(2,2,2);imagesc (c1, b1, log(a1));title ('Windows 125 Hrtz');
subplot(2,2,3);imagesc (c2, b2, log(a2));title ('Windows 375 Hrtz');
subplot(2,2,4);imagesc (c3, b3, log(a3));title ('Windows 1000 Hrtz');
%% Conclusion
%  vemos que mientras mas rapido pasa la ventana menos ruidoza es la vetana ya
%  que no ve tanto mas significativamente los los bruscos cambios que poosee esta
%  funcion.
%% external links
%%
% Porfavor, acceda a la documentacion:
%
% # Signal processing in octave <https://www.gnu.org/software/octave/doc/interpreter/Signal-Processing.html>
%
% # funcion specgram <https://octave.sourceforge.io/signal/function/specgram.html>
%
##### SOURCE END #####
-->
</body>
</html>
